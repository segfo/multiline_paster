# なにこれ
面倒くさい作業を自動化しよう。

1. 複数行をコピーしよう
2. ペーストしてみよう
3. みんな嬉しい

[使い方はこっち（動画説明あり）](https://qiita.com/segfo/items/7c92c9401dd1ce5ad02f)

# インストールの方法
## Rustがインストールされている場合
推奨
```
cargo install --git=https://github.com/segfo/multiline_paster
```

自分でバイナリを配置したい場合
```
git clone --recursive https://github.com/segfo/multiline_paster/
cd multiline_paster
cargo build --release
```

## Rustがインストールされてない場合
[リリース画面](https://github.com/segfo/multiline_paster/releases)から好きなものを持っていくが良い。

# 概要
```
multiline_paster.exe -h    
Usage: multiline_paster.exe [OPTIONS]

Options:
      --clipboard  動作モードがクリップボード経由でペーストされます（デフォルト：キーボードエミュレーションでのペースト） 本モードはバーストモードと排他です。
      --burst      バーストモード（フォームに対する連続入力モード）にするか選択できます。
  -h, --help       Print help information
  -V, --version    Print version information
```

# ツールの使い方
## バースト入力モード時（--burstオプション有効時）
|ショートカット|動作|
|---|---|
|CTRL+C|連続コピー|
|CTRL+V|自動連続ペースト|
|CTRL+ALT+C|クリップボード内データ全削除|

## 非バースト入力モード時
|ショートカット|動作|
|---|---|
|CTRL+C|連続コピー|
|CTRL+V|手動連続ペースト|
|CTRL+ALT+C|クリップボード内データ全削除|

# 動作モードについて
動作モードは2種類あります。
1. DirectInputモード
2. Clipboard経由モード

それぞれの特徴を説明します。
## DirectInputモード
キーボード入力をエミュレーションするモードです。  
デフォルトの挙動になります。  
### メリット
- クリップボードのデータを上書きしません
- コピペ禁止フォームに入力できます
- バースト入力モードが使えます

### デメリット
- 入力がClipboard経由モードよりも若干ゆっくりです

### 使い方
ペースト対象のアプリのIMEを切って使ってください。  
とにかくIMEを切れ。  
いいな、IMEを切るんだ。  
将来的にはIMEを自動的にオフる機能をつけるつもり。めんどいし。  

## Clipboard経由モード
クリップボードに存在するテキストデータを1行ごと上書きするモードです。  
### メリット
- IMEのモードに関わらず常にコピーしたデータが寸分違わずにペーストされます
- DirectInputよりも高速です
### デメリット
- クリップボードのデータが上書きされていきます。
- バーストモードは使えません。

### 使い方
`--clipboard`オプションを有効化することで使えます。
例：`multiline_paster --clipboard`

## バースト入力モード（通称：バーストモード）
TABキーを自動で入力して隣のフォームに移動しながら入力するモードです。  
`multiline_paster --burst`
v1.4以降のバージョンでは、フォーム移動がTABキー以外の場合でも対応できます。（矢印キーは除く）  
クリップボードモードでは使えません。  
（もしクリップボードモードで使いたかったらいい感じに改造してPull Request送ってほしい）  

## 連続コピー機能（v1.6+）
ペーストが連続で出来るのに、なんでコピーを連続で出来ないんだ？  
エクスペリエンス的にクソでは？と思ったので追加しました。

1. 以下のテキストに従って、1行ずつ`CTRL+C`を押します。
```
1行目：この行を1番目にコピーしてね
2行目：この行を3番目にコピーしてね
3行目：この行を4番めにコピーしてね
4行目：この行を2番めにコピーしてね
```
2. ペーストします。
```
1行目：この行を1番目にコピーしてね
4行目：この行を2番めにコピーしてね
2行目：この行を3番目にコピーしてね
3行目：この行を4番めにコピーしてね
```
コピーした順にペーストされるよ！  
という機能でございます。