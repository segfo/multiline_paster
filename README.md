# なにこれ
面倒くさい作業を自動化しよう。

1. 複数行をコピーしよう
2. ペーストしてみよう
3. みんな嬉しい

[使い方はこっち（動画説明あり）](https://qiita.com/segfo/items/7c92c9401dd1ce5ad02f)

# インストールの方法
[リリース画面](https://github.com/segfo/multiline_paster/releases)から好きなものを持っていくが良い。

|置いてあるもの|内容|おすすめ度合い|
|---|---|---|
|full_package|プラグインと実行ファイルのセット|万人向け|
|plugins.zip|プラグインとプラグインインストール用のスクリプト|cargo install --gitでインストールする人におすすめ|

あとは自由にパスを通してよしなに使ってほしい。

# 機能概要
|機能|v1.6.x|v2.0.0+|
|---|---|---|
|キーボードエミュレーション|O|O
|クリップボード経由のコピー|O|O
|拡張機能|X|O|
|ホットキー無効化|X|O|

プラグインのインストール先は、インストールされたバイナリと同じディレクトリに作成される  
`multiline_paster_plugins`フォルダです。  
実行したディレクトリに有るconfig.tomlに記述することで変更できます。  
また、`logic_config.toml`はプラグインの読み込みなど、プログラムの挙動を細かく変更できます。

## 設定ファイルの説明
|キー|役割|
|---|---|
|tabindex_key|TabIndexの通り、ペーストが完了した際タブを押下して次のフォームへ移動しようと試みます。(Clipboardモードでは無視されます)|
|line_delay_msec|1行ペーストした後に入るディレイ（ミリ秒）を設定します。連続で複数行ペーストする際の挙動を安定させる役割があります。（バースト入力モードでのみ使用されます）|
|char_delay_msec|1文字入力毎に入るディレイ（ミリ秒）を設定します。特に意味はありません。ライブコーディングを成功させたいような時に使える機能です。ブラッディ・マンデイみのあるデモ動画に使えるかもしれません。|
|max_line_length|コピーの出来る1行あたりの最大文字数です。改行までが長すぎるとひたすらに待たされます。そのような長大な文字列を誤ってコピーしないように制限をかけています。0で解除できます。|
|text_encoders|プラグインです。ペースト時に文字列をエンコードするように動作します。様々な機能があります。詳しくは各プラグインのヘルプ（`multiline_paster --installed-plugins`）を確認してください。|

### 設定ファイルのサンプル
```logic_config.toml
tabindex_key = "\t"
line_delay_msec = 200
char_delay_msec = 0
copy_wait_msec = 250
max_line_length = 512
# 以下のようにコメントアウトも出来ます
# text_encoders=["multiline_paster_encoder_jwt.dll"]
text_encoders=["multiline_paster_encoder_jwt.dll","multiline_paster_encoder_rot13.dll"]
```

# ツールの使い方
## バースト入力モード時（--burstオプション有効時）
|ショートカット|動作|
|---|---|
|CTRL+C|連続コピー|
|CTRL+V|自動連続ペースト|
|CTRL+ALT+C|クリップボード内データを全削除する|
|CTRL+ALT+Z|クリップボード内データの最新のコピーデータを一つ削除する|

## 非バースト入力モード時
|ショートカット|動作|
|---|---|
|CTRL+C|連続コピー|
|CTRL+V|手動連続ペースト|
|CTRL+ALT+C|クリップボード内データを全削除する|
|CTRL+ALT+Z|クリップボード内データの最新のコピーデータを一つ削除する|

# 動作モードについて
動作モードは2種類あります。
1. DirectInputモード
2. Clipboard経由モード

それぞれの特徴を説明します。
## DirectInputモード
キーボード入力をエミュレーションするモードです。  
デフォルトの挙動になります。  
### メリット
- クリップボードのデータを上書きしません
- コピペ禁止フォームに入力できます
- バースト入力モードが使えます

### デメリット
- 入力がClipboard経由モードよりも若干ゆっくりです

### 使い方
ペースト対象のアプリのIMEを切って使ってください。  
とにかくIMEを切れ。  
いいな、IMEを切るんだ。  
将来的にはIMEを自動的にオフる機能をつけるつもり。めんどいし。  

## Clipboard経由モード
クリップボードに存在するテキストデータを1行ごと上書きするモードです。  
### メリット
- IMEのモードに関わらず常にコピーしたデータが寸分違わずにペーストされます
- DirectInputよりも高速です
### デメリット
- クリップボードのデータが上書きされていきます。
- バーストモードは使えません。

### 使い方
`--clipboard`オプションを有効化することで使えます。
例：`multiline_paster --clipboard`

## バースト入力モード（通称：バーストモード）
TABキーを自動で入力して隣のフォームに移動しながら入力するモードです。  
`multiline_paster --burst`
v1.4～v1.6.xのバージョンでは、`config.toml`を変更することでフォーム移動がTABキー以外の場合でも対応できます。（矢印キーは除く）  
v2.0以降のバージョンでは`logic_config.toml`を変更することで同様に変更できます。
クリップボードモードでは使えません。  
（もしクリップボードモードで使いたかったらいい感じに改造してPull Request送ってほしい）  

## 連続コピー機能（v1.6+）
ペーストが連続で出来るのに、なんでコピーを連続で出来ないんだ？  
エクスペリエンス的にクソでは？と思ったので追加しました。

1. 以下のテキストに従って、1行ずつ`CTRL+C`を押します。
```
1行目：この行を1番目にコピーしてね
2行目：この行を3番目にコピーしてね
3行目：この行を4番めにコピーしてね
4行目：この行を2番めにコピーしてね
```
2. ペーストします。
```
1行目：この行を1番目にコピーしてね
4行目：この行を2番めにコピーしてね
2行目：この行を3番目にコピーしてね
3行目：この行を4番めにコピーしてね
```
コピーした順にペーストされるよ！  
という機能でございます。